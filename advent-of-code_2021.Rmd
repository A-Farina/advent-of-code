---
title: "Advent of Code 2021"
date: "12/1/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

This Rmarkdown document will be used for the [2021 Advent of Code](https://adventofcode.com/2021)

# Day 1

```{r}
dat <- rio::import(here::here("data", "depth.csv")) %>% 
  mutate(increase = ifelse(dplyr::lead(depth) > depth, 1, 0),
         three_score = depth + dplyr::lead(depth) + dplyr::lead(depth, n = 2),
         three_score_increase = ifelse(dplyr::lead(three_score) > three_score, 1, 0))
```

```{r}
# Part 1:
sum(dat$increase, na.rm = TRUE)

# Part2:
sum(dat$three_score_increase, na.rm = TRUE)
```

----------------------------------------------------
# Day 2

```{r}
dat <- rio::import(here::here("data", "day2.xlsx")) %>%
  tidyr::separate(col = direction, 
                  into = c("direction", "distance"),
                  sep = " ") %>% 
  mutate(distance = as.numeric(distance))
```


```{r}
# Part 1:
dat %>%
  mutate(horizontal = ifelse(direction %in% c("forward"), distance, 0),
         depth = ifelse(direction %in% c("up"), -distance,
                        ifelse(direction %in% c("down"), distance, 0))) %>% 
  summarize(horizontal = sum(horizontal),
                  depth = sum(depth),
                  position = sum(horizontal) * sum(depth))

# Part 2:
dat %>% 
  mutate(forward = ifelse(direction %in% c("forward"), distance, 0),
         adjust = ifelse(direction %in% c("up"), -distance,
                        ifelse(direction %in% c("down"), distance, 0)),
         horizontal = cumsum(forward),
         aim = cumsum(adjust),
         depth = cumsum(forward * aim))  %>% 
  slice_tail(n = 1) %>% 
  summarize(horizontal = horizontal,
            depth = depth,
            position = horizontal * depth)

```

